extend loggedin
block script
  script(type='text/javascript').
    function onButtonClicked() { 
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "api/boiler/on", false);
        xhr.send();
    }
    function offButtonClicked() { 
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "api/boiler/off", false);
        xhr.send();
    }
    function displayTemperature(temperature) {
        document.getElementById("currentTemperature").innerHTML = temperature.temperature + "&deg;C";
        var ranges = [0,1,4,7,10,13,16,19,22,25];
        var i = 0;
        while(i < ranges.length) {
            if(temperature.temperature < ranges[i]) break;
            ++i;
        }
        var tempClass = ranges[Math.max(i-1, 0)];
        document.getElementById("temperaturetile").title = tempClass;
    }
    function scheduleTemperatureReload() {
        window.setTimeout(loadTemperature, 60000);
    }
    function loadTemperature() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if(xhr.status === 200) {
                    var jsonResponse = JSON.parse(xhr.responseText);
                    displayTemperature(jsonResponse);
                }
                scheduleTemperatureReload();
            }
        }
        xhr.open('GET', 'api/temperature/currentTemperature', true);
        xhr.send(null);
    }
    function displayBattery(battery) {
        document.getElementById("currentBattery").innerHTML = battery.batteryVoltage + "V";
    }
    function scheduleBatteryReload() {
        window.setTimeout(loadBattery, 300000);
    }
    function loadBattery() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    var jsonResponse = JSON.parse(xhr.responseText);
                    displayBattery(jsonResponse);
                }
                scheduleBatteryReload();
            }
        }
        xhr.open('GET', 'api/battery/currentVoltage', true);
        xhr.send(null);
    }
    function loadValues() {
        loadTemperature();
        loadBattery();
    }
    window.onload = function(){ loadValues(); }

block content

  #temperaturetile.tile
      div.tile-body.tile-body-large
          #currentTemperature
              span.glyphicon.glyphicon-repeat.gly-spin(aria-hidden='true')

  #batterytile.tile
      div.tile-body.tile-body-large
          #currentBattery
              span.glyphicon.glyphicon-repeat.gly-spin(aria-hidden='true')

  button.btn.btn-lg.btn-success.btn-block(onclick='onButtonClicked()').
    ON

  br
  br

  button.btn.btn-lg.btn-danger.btn-block(onclick='offButtonClicked()').
    OFF